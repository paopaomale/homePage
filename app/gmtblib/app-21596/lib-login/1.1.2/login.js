!function(a,b,c){function d(a){var b=new RegExp("(?:^|;\\s*)"+a+"\\=([^;]+)(?:;\\s*|$)").exec(g.cookie);return b?b[1]:c}function e(){return h.indexOf("AliApp")>0||h.match(/ttid\=[^@]+@[^_]+_[^_]+_[\d\.]+/)||j.match(/ttid\=[^@]+@[^_]+_[^_]+_[\d\.]+/)||h.indexOf("WindVane")>0}function f(a,b){var c="http://"+["login",k.config.subDomain,k.config.mainDomain].join(".")+"/"+k.config.name+"?tpl_redirect_url="+encodeURIComponent(a||location.href);if(e()){var d=g.createElement("a"),f=g.createEvent("HTMLEvents");d.style.display="none",d.href=c,g.body.appendChild(d),f.initEvent("click",!1,!0),d.dispatchEvent(f)}else b?location.replace(c):location.href=c}var g=a.document,h=a.navigator.userAgent,i=location.hostname,j=a.location.search,k=b.login=b.login||{},l=/.*?([^.]+)(?:\.x)?\.(taobao|tmall|etao|alibaba|alipay|aliyun)\.(com|net).*/i,m=function(){var a=i.indexOf("x.taobao.net")>0?"waptest":"m",b=i.match(l);return!b||"waptest"!==b[1]&&"wapa"!==b[1]&&"m"!==b[1]||(a=b[1]),a}();k.config={name:"login.htm",mainDomain:"taobao.com",subDomain:m},k.isLogin=function(a){if(!a||!b.mtop){var d=this.getUserNick();return!!d}b.mtop.request({api:"mtop.user.getUserSimple",v:"1.0",data:{isSec:0}},function(d){d.retType===b.mtop.RESPONSE_TYPE.SUCCESS?a(!0,d):a(c)},function(d){d.retType===b.mtop.RESPONSE_TYPE.SESSION_EXPIRED?a(!1):a(c)})},k.getUserNick=function(){var a="",b=d("_w_tb_nick"),c=d("_nk_")||d("snk");return b&&b.length>0&&"null"!=b?a=decodeURIComponent(b):c&&c.length>0&&"null"!=c&&(a=unescape(unescape(c).replace(/\\u/g,"%u"))),a},k.goLogin=function(a){a=a||{},a.targetUrl=a.targetUrl||a.redirectUrl||a.rediUrl,!e()&&a.widget===!0&&this.widget?this.widget.showLogin(a):f(a.targetUrl,!e()&&a.replace)},k.getNickFromCookie=k.getUserNick}(window,window.lib||(window.lib={}));