define("mui/zebra-task-main/index",function(a,t,e){a("mui/kissy-polyfill/index");var i=a("mui/zepto/zepto");a("mui/zepto/event");var o=a("mui/lazyload/index");var n=a("mui/zebra-task-main/task-count");var s=a("mui/zebra-task-main/server");var r=a("mui/zebra-task-main/omission");var l=a("mui/zebra-task-main/smission");var d=a("mui/zebra-task-main/util");var c=d.getParam;var p=d.concatUrl;var u=a("mui/zebra-task-main/report");var f=u.report;var m=u.log;var v=u.reportPv;var g=a("mui/zebra-task-main/pop");var w=g.showCommonBox;var h=g.showAuth;var k=g.showErrorBox;var b=g.showNotSupportBox;var y=a("mui/zebra-task-main/security");var x=y.securityVerify;var C=a("./slider");var X=0;var I=1;var M=0;var T="";var z=1;var _=3;var D=50;var V="";var A=0;window._CTK5737=window._CTK5737||function(){var a={},t="",e=0;function i(a){var t=0,e,i,o;if(a.length===0)return t;for(e=0,o=a.length;e<o;e++){i=a.charCodeAt(e);t=(t<<5)-t+i;t|=0}return t}return function(o,n,s,r){r=r||{};if(r.reject){if(typeof r.reject!="object"){r.reject=[r.reject]}for(var l=r.reject.length-1;l>=0;l--){if(a[r.reject[l]]){return}}}if(!t){t=n}var d=(new Date).valueOf();a[n]=d;var c;if(n==t){var p=window.g_config&&g_config.startTime;c=p?d-p:0}else{c=d-(a[s||t]||a[t])}switch(r.autoGroup){case"time":r.group=r.autoGroup+"_"+(c<=0?0:Math.floor(Math.log(c)/Math.log(2)));break}if(typeof o=="object"){o=o[r.group||"_"]||Math.round(Math.log((undefined||8192)/(undefined||1/16))/Math.log(2))}function u(){var a=(window.location.search||"").slice(1).split("&");var t={};var e,i;for(i=a.length;i--;){if((e=a[i].split("=")).length!==2)continue;t[e[0]]=e[1]}return t.ctk==="true"}var f=u();var m=null,v=m&&m[Math.floor((d+288e5)/(864e5/144))%144]||1,g=f?1:Math.round(Math.max(Math.pow(2,o)*v/(undefined||8192),1));if(Math.floor(Math.random()*g)>0){return}function w(a,t){var o="undefined"+e++,n=window[o]=new Image;n.onload=n.onerror=function(){window[o]=null};var s=["type="+encodeURIComponent(r.type||"normal"),"name="+encodeURIComponent(a),"parent="+encodeURIComponent(t||""),"module="+encodeURIComponent(r.dataId||"322"),"msg="+encodeURIComponent(r.msg||""),"version="+encodeURIComponent("4.1.22"),"sample="+g,"time="+(c>0?c:0)].join("&");n.src="//gm.mmstat.com/tmjs.1.1?"+s+"&hash="+i(s)}if(r.group){w(n+"|"+r.group,n)}w(n,s)}}();_CTK5737(19,"codetrack.init");var S=0;_CTK5737(19,"mcity.init","codetrack.init");function U(a){V=i("meta[name='spm-id']").attr("content");H(a);C.v2();i(window).on("forceRefresh",function(t){E(a)});if(Ali.isWeb){Ali.isLogin(function(t){R(a)})}else{R(a)}try{var t=false;var e=Ali.plugin.pageVisibility.watch(function(e){if(e.errorCode){return}if(e.visible){if(t){if(A){return window.location.reload()}E(a)}}else{t=true}})}catch(n){console.log("loadPlugins callback error",n.message)}i(window).on("securityCheck",function(a){A=1});setTimeout(function(t){if(i(".brand-item-wrap a",a).length!==0){i(".brand-flag",a).show();new o(i(".brand-flag",a))}},0);if(lib.env.os.isAndroid){Ali.toast=function(a){}}}function j(a){s.getMission({givefundInfo:true,opageNo:1,opageSize:D,spageNo:1,spageSize:_*z,activityOPageNo:0,activityOSize:0,templateId:2},a)}function R(a){j(function(t){if(!t||!t.data||!t.data.data){if(S<3){R(a)}else{B("true");_CTK5737(0,"error:mission.null","mcity.init",{msg:"no data",type:"error"});if(Ali.isWeb&&document.domain.indexOf("zebra.alibaba-inc.com")<0){g.showCommonBox(".pop-not-tmall",a)}}S++;return}var e=t.data.data;r.init(e);l.init(e,{spageSize:_});N(e);if(X){i(".no-login-wrap").removeClass("no-login-wrap")}var o=e.fundsDetail;if(o){F(o,a)}B(e.closing,1)})}function N(a){X=""+a.isLogin=="true";I=""+a.alipayCertified=="true";M=""+a.securityCheck=="true";sigTokent=a.sigTokent;T=a.sigSessionId}function E(a){j(function(t){if(!t||!t.data||!t.data.data){return}var e=t.data.data;r.update(e.officialMission);l.update(e);N(e);r.updateVal(e);l.updateVal(e);var i=e.fundsDetail;if(i){F(i,a)}B(e.closing,1)})}function F(a,t){var e=parseInt(a.defendRemainTime,10);var o=new Date(e);i(".funds-total-count",t).html(a.todayLeftChance>0?a.todayLeftChance:0);if(o.getDate()){var s=24*60*60*1e3;var r=Math.floor(e/s);var l=Math.floor(e%s/(60*60*1e3));var d=Math.floor((e-r*s-l*60*60*1e3)/(60*1e3));i(".timeup-detal",t).html("<i>"+r+"</i>\u5929<i>"+l+"</i>\u65f6<i>"+d+"</i>\u5206")}i(".task-progress-total span",t).html(a.totalValue);if(a.totalValue==a.defendedValue&&a.totalValue!=0){i(".task-progress-desc",t).html("\u55b5\uff5e\uff0c\u672c\u671f"+a.totalValue+"\u732b\u70b9\u4f60\u5df2\u5168\u90e8\u83b7\u5f97\uff01").css({"text-align":"center"});i(".task-progress-bg",t).css({width:"100%"});i(".task-progress-total",t).hide()}else if(parseInt(a.defendedValue,10)>0){i(".task-progress-desc",t).html("\u5df2\u8d5a"+a.defendedValue+"\u732b\u949e");var c=parseFloat(a.defendedPercent)*100;if(!lib.env.os.isIOS){c=Math.max(3,c)}i(".task-progress-bg",t).css({width:c+"%"})}if(X){i(".task-info-wrap",t).removeClass("no-login-wrap");i(".login-tip",t).show();i(".no-login-tip",t).hide()}else{i(".task-info-wrap",t).addClass("no-login-wrap");i(".login-tip",t).hide();i(".no-login-tip",t).show()}i(".funds-exchangeable-value",t).html(a.exchangeableValue);if(""+a.showMessage!=="true"&&X&&Ali.isTmall){i(window).on("scroll",function(t){var e=window.scrollY;var o=i(".task-list-wrap").offset().top;var s=i(window).height();if(e+s-s/2>=o){i(window).off("scroll");setTimeout(function(t){n.autoShow(a)},0)}})}if(""+a.showMessage!=="true"||!X){i(".task-mask-wrap",t).hide();return}var p=a.attributesVO;if(p){var u=0;switch(parseInt(p.type,10)){case-1:i(".task-status-0-1 .total-flag",t).html(p.autoExchangeCouponValue*100);i(".task-status-0-1 .money-flag",t).html(p.autoExchangeCouponValue);if(p.transferToNext>0){i(".task-status-0-1 .remain-flag i",t).html(p.transferToNext)}else{i(".task-status-0-1 .remain-flag",t).html('\u5230\u65f6\u53ef\u5728"\u5df2\u83b7\u5956\u52b1"\u4e2d\u67e5\u770b')}break;case 0:break;case 1:i(".task-status-01 .remain-flag",t).html(p.transferToNext);break;case 2:i(".task-status-02 .exchange-flag",t).html(p.autoExchangeCouponValue);u=1;break;case 3:i(".task-status-03 .exchange-flag",t).html(p.autoExchangeCouponValue);i(".task-status-03 .remain-flag",t).html(p.transferToNext);u=1;break}i(".task-mask-wrap, .task-status-0"+p.type,t).show();if(u==0){i(".task-mask-bottom",t).removeClass("double-btn")}}else if(a.showReason=="SR00"||a.showReason=="SR01"){i(".task-mask-wrap, .task-status-04",t).show();var f=a.totalValue+"\u732b\u949e";var m=parseInt(a.now,10);if(m<1445616e6||m>1446307199e3){f+="\uff08\u53ef\u5151\u6362\u6210"+a.totalValue/100+"\u5143\u5929\u732b\u8d2d\u7269\u5238\uff09"}i(".task-status-04 .total-flag",t).html(f);var v=new Date(parseInt(a.cycleStartDate));var g=new Date(parseInt(a.cycleEndDate));i(".task-status-04 .date-flag",t).html(v.getFullYear()+"\u5e74"+(v.getMonth()+1)+"\u6708"+v.getDate()+"\u65e5-"+(g.getMonth()+1)+"\u6708"+g.getDate()+"\u65e5\uff08"+(a.days||new Date(g-v).getDate())+"\u5929\uff09");i(".task-mask-bottom",t).removeClass("double-btn")}else{i(".task-mask-wrap",t).hide()}}function B(a,t){if(""+a=="true"){if(!t){i(".bg-red").hide();i(".task-official-wrap").hide()}var e=i("#planBTpl").html();console.log(e);var o=i(".task-list-wrap ul");i(".task-list-wrap ul").html(e).removeClass("no-task-list");i(".task-list-wrap").show();i(".next-page-wrap").hide();f("/uaward.20150922.20","","","H46985919")}}function H(a){i(".btn-open-task",a).on("click",function(t){var e=i(this);if(e.hasClass("opening")){return}e.addClass("opening");s.openMission(function(t){var o=t.data;if(o){if(o.success=="true"||o.code=="E_FUND_DEFENDING"){i(".task-mask-wrap",a).hide();j(function(t){var e=t.data;e=e.data;var o=e.fundsDetail;if(o){F(o,a);i(".task-mask-wrap",a).hide()}})}else{k(a)}}e.removeClass("opening")});f("/uaward.20150922.10","","","H46985919")});i(".pop-no-support .btn-download-app",a).on("click",function(a){if(lib.env.os.isIOS){window.location.href="https://itunes.apple.com/cn/app/tian-mao-shi-shang-gou-wu/id518966501?spm="+V}else{window.location.href="http://m.laiwang.com/wow/portal/act/app-download?downloadOnly=1&spm="+V}});i(".pop-not-tmall .btn-download-app,.pop-canot-draw .btn-download-app",a).on("click",function(a){window.location.href="http://m.laiwang.com/wow/portal/act/app-download?type=web&mmstat=mcity&key="+encodeURIComponent("http://pages.tmall.com/wow/lafite/act/kitty?origin=nottmall")+"&spm="+V});i(".pop-container").on("touchmove",function(a){a.preventDefault()})}f("/uaward.20150922.17","","origin="+c("origin"),"H46985947");e.exports=U});