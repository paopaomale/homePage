define("mui/zebra-task-main/smission",function(a,t,i){var e=a("mui/zepto/zepto");a("mui/zepto/event");var r=a("mui/lazyload/index");var o=a("mui/zebra-task-main/server");var s=a("mui/zebra-task-main/util");var n=s.getParam;var l=s.concatUrl;var u=a("mui/zebra-task-main/report");var d=u.report;var p=u.log;var m=u.reportPv;var c=a("mui/zebra-task-main/pop");var v=c.showCommonBox;var f=c.showAuth;var g=c.showErrorBox;var h=c.showNotSupportBox;var w=a("mui/zebra-task-main/security");var k=w.securityVerify;var b=e(".zebra-task-main");var y=e("meta[name='spm-id']").attr("content");var z=0;var x=1;var I=0;var C="";var T=0;var M={init:function U(a,t){var i=t.spageSize;var r=this.parseHTML(a.shopMission,"shopMission");if(r&&r.length){e(".task-list-wrap ul",b).removeClass("no-task-list");if(typeof a.sHasMore=="undefined"){if(a.shopMission.length==i){e(".next-page-wrap",b).show()}else{e(".next-page-wrap",b).show();e(".next-page-wrap .btn-next-page",b).addClass("no-next-page")}}else{if(""+a.sHasMore=="true"){e(".next-page-wrap",b).show()}else{e(".next-page-wrap",b).show();e(".next-page-wrap .btn-next-page",b).addClass("no-next-page")}}}e(".task-list-wrap ul",b).html(r);this.taskAnim(b);this.bindEvent();m(a.shopMission);this.updateVal(a)},taskAnim:function X(a){e(window).on("scroll",function(){var t=e(".task-list-wrap li",a);var i=window.scrollY;var r=window.innerHeight;var o=Math.floor((i+r)/130)+1;for(var s=0;s<o;s++){if(t[s]&&!e(t[s]).hasClass("normal")){e(t[s]).addClass("normal")}}});e(window).trigger("scroll");new r(e(".task-list-wrap"))},bindEvent:function A(){e(".task-list-wrap",b).on("click","li.normal",function(a){var t=a.currentTarget;var i=e(t).attr("data-id");var r=e(t).attr("data-userTaskId");var s=e(t).attr("data-pageUrl");var n=e(t).attr("data-shopId");var l=e(t).attr("data-mtid");var u=e(t).attr("data-mcid");var m=e(t).attr("data-status");if(s.indexOf("?")>-1){s+="&"}else{s+="?"}if(lib.env.aliapp){if(lib.env.aliapp.version.lt("5.9.50")){s=location.protocol+s}}var g=location.protocol+"//shop"+n+".taobao.com";var h=y+".mcity."+i+"."+window.g_aplus_pv_id;var w=g+"?spm="+h+"&poplayer="+encodeURIComponent(s+"shopId="+n);if(m==31){v(".pop-task-full",b);return}if(!Ali.isTmall){return c.showCommonBox(".pop-not-tmall",b)}var M=function X(){Ali.pushWindow(w)};var U=function A(){if(!I&&sigTokent&&C){k(sigTokent,function(a){if(I)return;M();var t={token:sigTokent,sessionId:C,sig:a.sig};o.reportSecurity(t);I=1;T=1;e(window).trigger("securityCheck")})}else{M()}};if(z){if(x){U()}else{return f(b)}}else{Ali.login(function(a){if(a.errorCode==0){setTimeout(U,100)}else{Ali.toast("\u767b\u5f55\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01")}})}d("/uaward.20150922.6","","taskid="+i+"&mtid="+l+"&mcid="+u+"&shopid="+n+"","H46956155");p("wtxh.200.3?sdkpvid=&algopvid=&taskid="+l+"&shopid="+n+"&creativeid="+u+"&index=3&version=1.2.0-2.0&appkey=21784809&utdid=&bucket=0&v=1.0&logtype=2")})},parseHTML:function S(a,t){var i="";var e="";var r={shopMission:e,officialMission:i};if(!a){return""}var o={101:"\u5439\u8721\u70db\u8fce\u5e97\u5e86",102:"\u64e6\u6a71\u7a97\u770b\u65b0\u54c1",103:"\u62c6\u793c\u5305\u4eab\u60ca\u559c",104:"\u526a\u5f69\u5e26\u5e86\u5f00\u4e1a",105:"\u731c\u4ef7\u683c\u4eab\u7279\u6743\u4ef7"};for(var s=0;s<a.length;s++){if(a[s].status){a[s].status=parseInt(a[s].status,10)}if(a[s].compType){a[s].gameName=o[""+a[s].compType];a[s].compType=parseInt(a[s].compType,10)}}var n="";if(t=="shopMission"){n=this.parseShopHtml(a)}return n},parseShopHtml:function _(a){var t="";for(var i=0;i<a.length;i++){var e=a[i];var r=e.status;if(58498830==e.shopId&&document.domain!="pre-wormhole.tmall.com"){continue}var o=e.compType;t+='<li data-spm="'+e.id+'" data-id="'+e.id+'" data-userTaskId="'+e.userTaskId+'" data-pageUrl="'+e.pageUrl+'" data-status="'+e.status+'" data-shopId="'+e.shopId+'" data-mtid="'+e.mtid+'" data-mcid="'+e.mcid+'">';if(r===0||r===11||r===10||r===12){t+='<div class="task-item-wrap comptype-'+o+'">'}else{t+='<div class="task-item-wrap task-done comptype-'+o+'">'}t+='<div class="task-img-wrap">                            <img class="mui-lazy task-banner-img" data-src="'+e.coverBg+'_Q75" alt=" "  />                            <div class="task-shop-wrap">';if(o===101){t+='<div class="shop-task-title red">\u5e97\u5e86</div>'}else if(o===102){t+='<div class="shop-task-title blue">\u65b0\u54c1</div>'}else if(o===104){t+='<div class="shop-task-title yellow">\u5f00\u4e1a</div>'}t+='<div class="shop-brand-logo">                                    <img class="mui-lazy" src="'+e.coverIcon+'" alt=" " />                                </div>                                <div class="shop-award-slogan">'+e.coverLyDesc+"<br>"+e.coverSjDesc+'</div>                            </div>                        </div>                        <div class="task-desc-wrap">                            <div class="task-tile">'+e.gameName+'</div>                            <div class="task-award">                                <p>'+e.prizeValue+"</p>                                <span>&nbsp;\u732b\u949e</span>                                "+(o==105?'<div class="spec-price-flag">+\u7279\u6743\u4ef7</div>':"")+"                            </div>";if(r===11||r===12){t+='<div class="btn-do-task btn-doing-task"><span>\u4efb\u52a1\u5df2\u9886\u53d6</span><div class="icon-go-task"></div></div>'}else if(r===13){t+='<div class="btn-do-task btn-doing-task"><span>\u4efb\u52a1\u5df2\u5b8c\u6210</span><div class="icon-go-task"></div></div>'}else if(r===22){t+='<div class="btn-do-task btn-doing-task"><span>\u4efb\u52a1\u5df2\u8fc7\u671f</span></div>'}else if(r===23){t+='<div class="btn-do-task btn-doing-task"><span>\u4efb\u52a1\u5df2\u653e\u5f03</span><div class="icon-go-task"></div></div>'}else if(r===30||r===31){t+='<div class="btn-do-task btn-doing-task"><span>\u4efb\u52a1\u88ab\u62a2\u7206</span><div class="icon-go-task"></div></div>'}else{t+='<div class="btn-do-task"><span>\u505a\u4efb\u52a1</span><div class="icon-go-task"></div></div>'}t+="</div>                    </div>                </li>"}return t},update:function q(a){var t=a.shopMission;if(t){for(var i=0;i<t.length;i++){var r=t[i];var o=e(".task-list-wrap ul li[data-id='"+r.id+"']",b);var s=o.attr("data-status");var n=o.attr("data-id");if(r.id==n&&r.status!=s){var l="";var u=1;switch(parseInt(r.status,10)){case 11:case 12:l="\u4efb\u52a1\u5df2\u9886\u53d6";u=0;break;case 13:l="\u4efb\u52a1\u5df2\u5b8c\u6210";break;case 22:l="\u4efb\u52a1\u5df2\u8fc7\u671f";break;case 23:l="\u4efb\u52a1\u5df2\u653e\u5f03";break;case 30:case 31:l="\u4efb\u52a1\u88ab\u62a2\u7206";break}if(l){e(".btn-do-task",o).addClass("btn-doing-task");e(".btn-do-task span",o).text(l);if(u){e(".task-item-wrap",o).addClass("task-done")}}o.attr("data-status",r.status)}}}},updateVal:function N(a){z=""+a.isLogin=="true";x=""+a.alipayCertified=="true";I=""+a.securityCheck=="true";sigTokent=a.sigTokent;C=a.sigSessionId}};i.exports=M});