define("mui/lazyload/index",["mui/babel-polyfill/index"],function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e("mui/babel-polyfill/index");var s="data-src",a=window.innerHeight,l=a;"complete"!==document.readyState&&(l=0,window.addEventListener("load",function(){setTimeout(function(){l=a},100)}));var c={loadImg:function(e,t){var n=new Image;n.onload=t,n.src=e},onload:function(e){var t=function(){setTimeout(e,0)};"complete"===document.readyState?t():window.addEventListener("load",t)},debounce:function(e,t,n){var i=void 0,o=void 0;return function(){var r=this,s=arguments,a=function(){i=null,n||(o=e.apply(r,s))},l=n&&!i;return clearTimeout(i),i=setTimeout(a,t),l&&(o=e.apply(r,s)),o}},throttle:function(e,t){var n=void 0,i=void 0,o=void 0,r=void 0,s=void 0,a=void 0,l=c.debounce(function(){s=r=!1},t);return function(){n=this,i=arguments;var c=function(){o=null,s&&(a=e.apply(n,i)),l()};return o||(o=setTimeout(c,t)),r?s=!0:(r=!0,a=e.apply(n,i)),l(),a}},processElement:function(e){return"string"==typeof e?[].concat(o(document.querySelectorAll(e))):e instanceof HTMLElement?[e]:e instanceof HTMLCollection?[].concat(o(e)):e}},u=void 0,d=function(){function e(t,n){var o=this;i(this,e),t&&"function"==typeof t.get&&Array.isArray(t.get())&&(console.warn("LazyLoad is not support Zepto Node anymore."),t=t.get()),this.containers=t?c.processElement(t):[],this.images=[],this.bgEls=[],this.options=Object.assign({cls:"mui-lazy",bgCls:"mui-bg-lazy",scrollEl:window},n),"string"==typeof this.options.scrollEl&&(this.options.scrollEl=document.querySelector(this.options.scrollEl)),c.onload(function(){o.refresh()})}return r(e,[{key:"refresh",value:function(){var e=this;this.containers.forEach(function(t){t.images=[].concat(o(t.querySelectorAll("img["+s+"]."+e.options.cls))),t.bgEls=[].concat(o(t.querySelectorAll("["+s+"]."+e.options.bgCls)))}),this.resume(),this.load()}},{key:"addElements",value:function(e){this.containers=this.containers.concat(c.processElement(e)),this.refresh()}},{key:"loadSrc",value:function(e,t){var n=this,i=e.getAttribute(s);i&&!function(){var o={elem:e,src:i},r=n.options,a=r.beforeResolveImg,l=r.processor;l?o=l(o):a&&(console.warn("use processor, beforeResolveImg is deserted"),a(o)),c.loadImg(o.src,function(){t?(e.style["background-image"]="url("+o.src+")",e.classList.remove(n.options.bgCls)):(e.setAttribute("src",o.src),e.classList.remove(n.options.cls))}),e.removeAttribute(s)}()}},{key:"load",value:function(){var e=this,t=this.constructor.isInViewPort,n=this.diff;this.containers.forEach(function(i){if(t(i,n)){var o=function(i,o){return i.filter(function(i){var r=t(i,n);if(r){if(!i.getAttribute(s))return!1;e.loadSrc(i,o)}return!r})};i.images=o(i.images),i.bgEls=o(i.bgEls,!0)}}),this.containers.some(function(e){return e.images.length||e.bgEls.length})||this.pause()}},{key:"pause",value:function(){this._listener&&(this.options.scrollEl.removeEventListener("scroll",this._listener),window.removeEventListener("orientationchange",this._listener),delete this._listener)}},{key:"resume",value:function(){var e=this;this._listener||(this._listener=c.throttle(function(){e.load()},50),this.options.scrollEl.addEventListener("scroll",this._listener),window.addEventListener("orientationchange",this._listener))}},{key:"destroy",value:function(){this.pause()}},{key:"diff",get:function(){return void 0===this.options.threshold?l:this.options.threshold}}],[{key:"getInstance",value:function(){return u?u:new e}},{key:"isInViewPort",value:function(e,t){var n=e.getBoundingClientRect();return!(!n.width&&!n.height||n.top-window.innerHeight>=t||n.bottom+t<=0||n.right<=0||n.left-window.innerWidth>=0)}},{key:"addListener",value:function(e,t,n){function i(){r(e,o())&&(window.removeEventListener("scroll",i),window.removeEventListener("orientationchange",i),t())}n=n||{};var o=function(){return void 0===n.threshold?l:n.threshold},r=this.isInViewPort;return r(e,o())?t():(window.addEventListener("scroll",i),void window.addEventListener("orientationchange",i))}}]),e}();n.exports=d});