define("mui/zebra-dynamic/index",function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=e("mui/zepto/touch"),i=e("mui/zebra-dynamic/request");var c=function s(e){return Object.prototype.toString.call(e)==="[object Object]"};window.codeTrack=function(){};var u=function(){function e(t){a(this,e);codeTrack("dynamic.init");this.cfg=t;this.config=t.config||{};if(!this.cfg.data){codeTrack("error:init.error","dynamic.init",{msg:"conf\u53c2\u6570\u5fc5\u987b\u4e3ajson\u6216json\u5b57\u7b26\u4e32: "+this.cfg.data});throw new Error("conf\u53c2\u6570\u5fc5\u987b\u4e3ajson\u6216json\u5b57\u7b26\u4e32")}if(!this.request){var r=parseInt(this.config.timeout,10);r=!r?8e3:r>100?r:r*1e3;this.request=new i({timeout:r,duplication:this.config.duplication?true:false,mtop:this.config.mtop?true:false,params:c(this.config.params)?this.config.params:{}})}this.xPathList={};this._stringfiyToResult(this.cfg)}n(e,[{key:"_stringfiyToResult",value:function t(e){codeTrack("dynamic.parse","dynamic.init");var t=typeof e.data==="string"?JSON.parse(e.data):e.data,r=this,n=e.key,a=e.callback,o=n?t[n]:t;if(o){this._getData(o).then(a)["catch"](function(e){throw e})}else{var i=n+" is undefiend";codeTrack("error:tag.error","dynamic.parse",{msg:i});throw new Error(i)}}},{key:"_getData",value:function r(e){var t=this;this._parse(e);return!o.isEmptyObject(t.request.requestStack)?t.request.run().then(function(r){o.each(r,function(r,n){o.each(t.xPathList,function(t,a){if(r===a){(function(){var r=t.split("."),a=r.pop(),o=e;r.forEach(function(e,t){if(!e)return;o=o[e]});if(a){o[a]=n}else{e=n}})()}})});t.xPathList={};return e}):Promise.resolve(e)}},{key:"_parse",value:function u(e,t){var r=this;t=t||"";if(!this._isTag(e))return;var n=this._checkTagIsDynamic(e);if(n){this._push(e,n,t);return}o.each(e,function(e,n){if(!r._isTag(n))return;r._parse(n,t+"."+e)})}},{key:"_isTag",value:function s(e){return Array.isArray(e)||c(e)}},{key:"_push",value:function f(e,t,r){var n=Array.isArray(e),a=n?e[0]:e;this.xPathList[r]=t;this.request.push(a)}},{key:"_checkTagIsDynamic",value:function l(e){var t=Array.isArray(e);if(t){if(e.length>1){return false}return this._checkDataConfig(e[0])}return false}},{key:"_checkDataConfig",value:function d(e){if(!e||!c(e)){return false}var t=e.__data_type&&e.__data_source&&e.__data_url&&e.__data_param&&c(e.__data_param)&&e.__data_default;return t?e.__data_param.appId:false}}]);return e}();r.exports=function(e,t,r,n){if(o.isFunction(t)){n=r;r=t;t=null}return new u({data:e,key:t,callback:r,config:n})}});