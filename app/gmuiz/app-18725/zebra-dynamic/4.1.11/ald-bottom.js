define("mui/zebra-dynamic/ald-bottom",["mui/zebra-dynamic/io"],function(t,e,a){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),n=t("mui/zebra-dynamic/io"),c=function(){function t(){r(this,t),this.kcCache={}}return o(t,[{key:"getBottom",value:function(t){var e=this;return e.getBottomUrl(t).then(function(a){return e.getBottomData(a,t)})}},{key:"saveBottomUrl",value:function(t,e){var a=e.bottomUrl;return a||(a=this.createBottomUrl(e)),this.kcCache[t]=a,Promise.resolve(this.kcCache)}},{key:"getBottomUrl",value:function(t){var e=this.kcCache[t.appId];return e||(e=this.createBottomUrl(t)),Promise.resolve(e)}},{key:"createBottomUrl",value:function(t){var e=t.appId.split(",")||[],a=t.backupParams||{},r="//aladdin.alicdn.com/bottom/"+e.sort().join("/");return Object.keys(a).sort().forEach(function(t){r+="/"+t+"="+a[t]}),r+="/data.jsonp"}},{key:"createBottomCallback",value:function(t){var e=t.appId.replace(/-/g,"_").split(",")||[];e=e.sort();var a=t.backupParams||{},r="";Object.keys(a).sort().forEach(function(t){r+="_"+t+"_"+a[t]});var o="callback_"+e.join(",")+r;return o}},{key:"getBottomData",value:function(t,e){var a=this;return n("http",{url:t,dataType:"jsonp",params:{},timeout:e.timeout||2e3,callback:a.createBottomCallback(e)})}},{key:"mergeData",value:function(t,e,a){var r={},o=this;return e&&t.forEach(function(n){1===t.length&&a?(r[n]=e.data,o.exposure(e.exposureParam)):e[n]&&e[n].hasOwnProperty("data")&&(r[n]=e[n].data,o.exposure(e[n].exposureParam))}),Promise.resolve(r)}},{key:"exposure",value:function(t){t&&((new Image).src=t)}}]),t}();a.exports=new c});