define("mui/countdown/index",function(e,t,i){var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,i,r){if(i)e(t.prototype,i);if(r)e(t,r);return t}}();function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var n=e("mui/zepto/zepto"),s={format:"{d}\u5929{h}\u65f6{m}\u5206{s-t}\u79d2",autoFormat:true,timeToDouble:true,forceFrequency:null,_targetTime:null,_serverTime:null,rule:[],className:"mui-cd-normal"};var m=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var u=function(){function e(t,i){a(this,e);this.container=n(t);this.config=n.extend({},s,i);this.defaultHTML=this.container.html();this._init()}r(e,[{key:"_init",value:function t(){var e=(new Date).getTime(),t=this,i=t.config,r=t.container;var a=n(r).attr("data-servertime")||i._serverTime;var s=n(r).attr("data-targettime")||i._targetTime;if(!a&&!s){return}var u=+new Date;var o=parseFloat(s)-parseFloat(a);var f=parseFloat(u)-parseFloat(a);t._serverTime=a;t._targetTime=s;t._reminderTime=o;t._diffTime=f;t._timeCount=o;var c=1e3;var l=i.forceFrequency;if(l){c=parseFloat(l)}t._frequency=c;var h=t._ruleToFormat();var _=t._formateTimerStr(h);t.container.innerHTML=t.defaultHTML+_;this._hasBiggerBit=false;var v=(new Date).getTime();var d=t._frequency-v+e;t.timer=setTimeout(function(){m(function(){clearTimeout(t.timer);t._run.apply(t)})},d)}},{key:"_formateTimerStr",value:function i(e){var t=/{([\-\w]+)}/g,i=this;i._timeStringArray=new Array;if(!t.test(e)){return'<span class="mui-cd-infor">'+e+"</span>"}e.replace(t,function(e,t,r,a){i._frequency=1e3;var n=0,s="";switch(t){case"d":n=24*60*60*1e3;break;case"d1":n=10*24*60*60*1e3;break;case"d2":n=24*60*60*1e3;break;case"h":n=60*60*1e3;break;case"h1":n=10*60*60*1e3;break;case"h2":n=60*60*1e3;break;case"m":n=60*1e3;break;case"m1":n=10*60*1e3;break;case"m2":n=60*1e3;break;case"s":n=1e3;break;case"s1":n=10*1e3;break;case"s2":n=1e3;break;case"s-t":n=1e3;i._frequency=100}var m=a.substring(r+e.length);var u=m.indexOf("{");if(-1===u){s=m}else{s=m.substring(0,u)}s='<span class="mui-cd-format mui-cd-format'+t+'">'+s+"</span>";var o=i._getTimeData(n,s,t);i._timeStringArray.push(o);return""});return i._timeStringArray.join("")}},{key:"_getTimeData",value:function u(e,t,i){var r=this._timeCount,a="";if(1e3===e&&this._frequency===100){var n=r%1e3;n=Math.floor(n/100);a=parseInt(r/e);a=this._dataToHtml(a,t,i,n)}else{a=parseInt(r/e);r-=e*a;this._timeCount=r;a=this._dataToHtml(a,t,i)}return a}},{key:"_timeToDouble",value:function o(e){if(e<10){e="0"+e}return e}},{key:"_dataToHtml",value:function f(e,t,i,r){var a="";if(this.config.timeToDouble){e=this._timeToDouble(e)}if(this.config.autoFormat){if(this._hasBiggerBit){if(r||0===r){e+="."+r}a='<span class="mui-cd-time mui-cd-time'+i+'">'+e+"</span>"+t}else{if(0===parseFloat(e)){if(r){e+="."+r;a='<span class="mui-cd-time mui-cd-time'+i+'">'+e+"</span>"+t}else{a=""}}else{if(r||0===r){e+="."+r}a='<span class="mui-cd-time mui-cd-time'+i+'">'+e+"</span>"+t;this._hasBiggerBit=true}}}else{if(r||0===r){e+="."+r}a='<span class="mui-cd-time mui-cd-time'+i+'">'+e+"</span>"+t}return a}},{key:"_run",value:function c(){var e=(new Date).getTime(),t=this;var i=+new Date;var r=i-this._diffTime;this._reminderTime=this._targetTime-r;if(this._reminderTime<=0){this._reminderTime=0}this._timeCount=this._reminderTime;this._hasBiggerBit=false;var a=this._ruleToFormat();var n=this._formateTimerStr(a);this.container.html(this.defaultHTML+n);var s=(new Date).getTime();var u=this._frequency-s+e;this.timer=setTimeout(function(){m(function(){clearTimeout(t.timer);t._run.apply(t)})},u);if(this._when){this._fireWhen()}if(0===this._reminderTime){this.stop()}}},{key:"_ruleToFormat",value:function l(){var e=this.config,t=e.rule,i=t.length,r=null;if(0===i){return e.format}else{for(var a=0;a<i;a++){r=t[a];var n=r["timeRange"];var s=r["format"];var m=r["rangeControl"];var u=0;var o=null;var f="e";var c="n";if(n){u=n[0];o=n[1]}if(m){f=m[0];c=m[1]}var l=this._reminderTime;if("e"===f){if(l>=u){if(this._testEndRange(o,c,l)){this._addSpecialCls(r["className"]);return s}}}else{if(l>u){if(this._testEndRange(o,c,l)){this._addSpecialCls(r["className"]);return s}}}}this._addSpecialCls(e.className);return e.format}}},{key:"_addSpecialCls",value:function h(e){if(e){var t=this.container;var i=n(t).attr("data-classname")||"";n(t).removeClass(i);n(t).addClass(e);n(t).attr("data-classname",e)}}},{key:"_testEndRange",value:function _(e,t,i){if(e){if("e"===t){if(i<=e){return true}}else{if(i<e){return true}}}else{return true}return false}},{key:"_fireWhen",value:function v(){var e=this._reminderTime;var t=this._frequency;var i=this._when;var r=this._whenFlag;var a=e-t;var s=this;n.each(i,function(t,i){var n=i.time>=0?i.time:0;if(n<=e&&n>a){if(!r[t]){i.fun.apply(s);r[t]=true}}})}},{key:"when",value:function d(e){this._when=e;var t=[];for(var i=0;i<e.length;i++){t[i]=false}this._whenFlag=t;return this}},{key:"stop",value:function T(){clearTimeout(this.timer);return this}},{key:"reset",value:function g(){var e=this.container;var t=this.config;var i=n(e).attr("data-servertime")||t._serverTime;var r=n(e).attr("data-targettime")||t._targetTime;if(!i&&!r){return}var a=parseFloat(r)-parseFloat(i);this._serverTime=i;this._targetTime=r;this._reminderTime=a;this._timeCount=a;this.stop();this._run.apply(this);return this}}]);return e}();i.exports=u});