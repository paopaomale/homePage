var TB=KISSY.app?KISSY.app("TB"):KISSY;(function(e,a,t,n){var i=t.version==="1.20"||t.version==="1.1.6";function o(){var i=t;var o=n;var s=e.g_config=e.g_config||{};if(i){var r=s.loadedCss,l=s.seed;if(r&&r.length){for(var m in r){i.add(r[m],function(){})}}if(l){i.config(l)}}if((i.version>="1.40"||i.version.replace(/\./g,"")>="140")&&!s.removeGlobalAlias){i.config({modules:{sizzle:{alias:["node"]},calendar:{alias:["gallery/calendar-deprecated/1.0/"]},datalazyload:{alias:["gallery/datalazyload/1.1/"]},switchable:{alias:["gallery/switchable/1.3.1/"]},imagezoom:{alias:["gallery/imagezoom/1.0/"]},waterfall:{alias:["gallery/waterfall/1.0/"]},flash:{alias:["gallery/flash/1.0/"]}}})}o.loginHttp="https";o._isLoginStatusReady=false;o._loginStatusReadyFnList=[];o._isMemberInfoReady=false;o._memberInfoReadyFnList=[];o.userInfo={memberInfo:{}};o.instance={};var c=e;var u=a;var f=c.location.hostname.indexOf("tmall.com")>=0||c.location.hostname.indexOf("tmall.net")>=0||c.location.hostname.indexOf("tmall.hk")>=0;var d=/\.net$|com\.hk$/.test(c.location.hostname);var g=s.devId=="mobile"||s.devId=="m";var v=c.location.href.indexOf("https://")===0;var p="";var b="";o.environment=i.merge(o.environment||{},{isTmall:f,isDaily:d,isHttps:v});s.tmallConfig={commonJS:{memberInfo:{},tDog:{},tLabs:{},mpp:{},miniCart:{},brandBar:{},miniBag:{},checkB2BUser:{},shareFB:{}}};s.moduleTimeStamp={minilogin:"",globalCss:"",globalJs:""};var h=s.globalInstanceStatus={};var _=s.tmallConfig;var y={};var I=navigator.userAgent;var T=d?"assets.daily.taobao.net":"assets.alicdn.com";var w=d?"g-assets.daily.taobao.net":"g.alicdn.com";var M=i.unparam(c.location.search.substring(1));var C=i.Env.mods;var k=false;var S=+new Date;var L=4e3;var B=4e3;var x="load";var R="scroll";var F="mousemove keydown mousedown touchstart touchend";var j=!"0"[0];var H;if(I.indexOf("-PD/")>=0&&I.indexOf("AliApp")>=0){H=true}var N={isApp:false,passCookie:true,loginServer:g?"//login.tmall.com/":"//login.tmall.com/",logoutServer:g?"//login.m.taobao.com/logout.htm":"//login.taobao.com/member/logout.jhtml",registerServer:"//register.tmall.com/",spaceServer:"//vip.tmall.com",miaoxinServer:"//miaoxin.tmall.com",loginHkServer:"//www.tmall.hk/wow/member-club/act/login"};o.globalToolFn={isDaily:function(){return d},isPadApp:function(){return H},getAssetsHost:function(e){if(e==="g"){return w}else{return T}},isHttps:function(){return v},record:function(e){if(!e)return;(new Image).src=e},escapeHTML:function(e){var a=u.createElement("div"),t=u.createTextNode(e);a.appendChild(t);return a.innerHTML},isInBlacklist:function(){var e=_.commonJS.miniBag.blacklist;if(!e)return false;for(var a=0;a<e.length;a++){if(c.location.href.indexOf(e[a])>-1){return true}}return M.frm&&M.frm=="tmalltiyan"},available:function(e,a){var t=false;setTimeout(function(){t=true},5e3);setTimeout(function(){if(u.getElementById(e)){a()}else if(!t){setTimeout(arguments.callee,50)}},50)},contentReady:function(e,a){var t=false;setTimeout(function(){t=true},5e3);setTimeout(function(){var n=u.getElementById(e);if(n&&n.childNodes){a()}else if(!t){setTimeout(arguments.callee,50)}},50)},safeUse:function(e,a){if(i.version<"1.40"){e=e.replace("io","ajax")}i.use(e,a)},createLoader:function(e){var a,t,n=[],i;return function(o,s){if(s!==0&&!s){s=1}if(s&1&&!t){t=true;e(function(e){a=e;while(i=n.shift()){i&&i.apply(null,[a])}})}if(a!==undefined){o&&o.apply(null,[a]);return a}if(!(s&2)){o&&n.push(o)}return a}},whenInstanceReady:function(e,a){D(function(){i.ready(function(){if(h[e]){a(i,o.instance[e])}else{o.Global.on(e+":ready",function(){a(i,o.instance[e])})}})})},instanceHandler:function(e,a){D(function(){i.ready(function(){h[e]=true;o.instance[e]=a;o.Global.fire(e+":ready")})})},smartLazy:function(e,a){i.ready(function(){D(function(){var t=y.bodyEl||(y.bodyEl=u.body);var n=i.Event;var s;var r={scroll:true,action:true,load:true,timeout:true};if(i.isFunction(e)){r.callback=e;r.customDelay=a}else{r=i.merge(r,e)}var l=r.customDelay||L;var m=r.scroll;var f=r.action;var d=r.load;var g=r.timeout;var v=o.globalToolFn.createLoader(function(e){var a=function(){setTimeout(function(){e(true)},0);if(m){n.detach(c,R,o)}if(f){n.detach(t,F,o)}if(g){clearTimeout(s)}};var o=i.buffer(a);if(d){if(!k){n.on(c,x,function(){i.later(function(){a()},B)})}else{var r=+new Date;var u=B-(r-(S||r));i.later(function(){a()},u>0?u:0)}}if(g){s=setTimeout(o,l+B)}if(f){n.on(t,F,o)}if(m){n.on(c,R,o)}});if(i.isFunction(r.callback)){v(function(){r.callback()},1)}})})},formatPoint:function(e){var a="";if(e>=0&&e<1e4){a=e}else if(e==1e4){a="1\u4e07"}else if(e<1e5){a=parseInt(e/1e3)/10+"\u4e07";if(e%1e3>0){a+="+"}}else if(e<1e6){a=parseInt(e/1e4)+"\u4e07";if(e%1e4>0){a+="+"}}else if(e<1e7){a=parseInt(e/1e6)+"\u767e\u4e07";if(e%1e6>0){a+="+"}}else if(e<1e8){a=parseInt(e/1e7)+"\u5343\u4e07";if(e%1e7>0){a+="+"}}else{a=parseInt(e/1e8)+"\u4ebf";if(e%1e8>0){a+="+"}}return a},getLoginUrl:function(){if(p){return p}else{var e=N.loginServer;var a=N.loginHkServer;var t=c.location.href;if(/^http.*(\/member\/login\.jhtml)$/i.test(t)){t=""}var n=N.redirectUrl||t;var i=n;if(n){if(s.isInternational||s.bizId==="hk"){e=a+"?redirect_url="+encodeURIComponent(i)}else{e+="?redirectURL="+encodeURIComponent(i)}}if(d){e="//login.daily.taobao.net/?redirect_url="+encodeURIComponent(i)}return p=e}},getLogoutUrl:function(){if(b){return b}else{var e="";if(d){e="//login.daily.taobao.net/member/logout.jhtml?f=top&redirectURL="+(g?encodeURIComponent(c.location.href):encodeURIComponent(A()))}else{e=N.logoutServer+"?redirectURL="+(g?encodeURIComponent(c.location.href):encodeURIComponent(A()))}return b=e}},requestFragment:function(e,a){E("io",function(){var t;if(e&&i.isString(e)&&e.indexOf("/")){t=e.split("/")[1];i.IO({url:"//fragment.tmall.com/"+e,data:{wh_callback:true},dataType:"jsonp",scriptCharset:"utf-8",jsonpCallback:t,complete:a,timeout:5})}})}};var U=o.globalToolFn.escapeHTML;var E=o.globalToolFn.safeUse;var q=o.globalToolFn.record;var A=o.globalToolFn.getLoginUrl;var D=function(e){E("dom, event, cookie, ua",e)};o.Global={_elCont:y,_siteNavConfig:N,_initLoginStatus:function(){var e=o.Global;var a=o.userInfo;var t=i.Cookie.get("_nk_")||"";t=U(unescape(t.replace(/\\u/g,"%u")));var n=i.Cookie.get("_l_g_")||"";e._seedLoginApi(function(){o.userInfo.status="success";a.nick=U(unescape(userCookie["_nk_"].replace(/\\u/g,"%u")));a.tracknick=U(unescape(userCookie["tracknick"].replace(/\\u/g,"%u")));a.isLogin=!!(userCookie["_l_g_"]&&a.nick);a.trackId=userCookie["t"]||"";a.unb=userCookie["unb"]||"";a.uc1=userCookie["uc1"]||"";a.cookie2=userCookie["cookie2"]||"";a.tbToken=userCookie["_tb_token_"]||"";a.isMallSeller=!!i.unparam(a.uc1).tmb;if(a.isLogin&&(a.nick!=t||!a.tbToken)){var n="//tmcc.tmall.com/pass.htm";if(d){n="//tmcc.daily.tmall.net/pass.htm"}q(n)}e._fireLoginStatusReadyFnList()},function(){o.userInfo.status="error";e._fireLoginStatusReadyFnList()})},_seedLoginApi:function(e,a){var t="//www.taobao.com/go/app/tmall/login-api.php";if(d){t="//www.daily.taobao.net/go/app/tmall/login-api.php"}t+="?"+Math.random();i.getScript(t,{success:e,error:a,timeout:3})},loginStatusReady:function(e){if(o._isLoginStatusReady){e.call(c,o.userInfo)}else{if(o._loginStatusReadyFnList){o._loginStatusReadyFnList.push(e)}}},_fireLoginStatusReadyFnList:function(){if(o._isLoginStatusReady){return}o._isLoginStatusReady=true;if(o._loginStatusReadyFnList){for(var e=0;e<o._loginStatusReadyFnList.length;e++){o._loginStatusReadyFnList[e].call(c,o.userInfo)}o._loginStatusReadyFnList=[]}},_initMemberInfo:function(){var e=o.Global;var a=o.userInfo;var t="//top-tmm.taobao.com/member/query_member_top.do";if(d){t="//tmm.daily.taobao.net/member/query_member_top.do"}t+="?callback=_initMemberInfoCallback&is_new=true&t="+i.now();c._initMemberInfoCallback=function(t){a.memberInfo=t;a.memberInfo.cookies={unb:{value:a.unb},t:{value:a.t},uc1:{value:a.uc1},login:true};a.memberInfo.mallSeller=a.isMallSeller;a.memberInfo.status="success";e._fireMemberInfoReadyFnList()};i.getScript(t,{error:function(){a.memberInfo.status="error";e._fireMemberInfoReadyFnList()},timeout:3})},memberInfoReady:function(e){if(o._isMemberInfoReady){e.call(c,o.userInfo)}else{if(o._memberInfoReadyFnList){o._memberInfoReadyFnList.push(e)}}},_fireMemberInfoReadyFnList:function(){if(o._isMemberInfoReady){return}o._isMemberInfoReady=true;if(o._memberInfoReadyFnList){for(var e=0;e<o._memberInfoReadyFnList.length;e++){o._memberInfoReadyFnList[e].call(c,o.userInfo)}}},isLogin:function(){var e=i.Cookie.get("tracknick"),a=i.Cookie.get("_nk_")||e;return!!(i.Cookie.get("_l_g_")&&a||i.Cookie.get("ck1")&&e)}};D(function(){i.log("::global::begin use global module");i.Event.on(c,"load",function(){k=true;S=+new Date});if(C["mui/global-pc"]&&!g){i.use("mui/global-pc")}o.Global=i.mix(o.Global,i.EventTarget);o.Global.on("mainReady",function(){o.Global.isMainReady=true});i.ready(function(){if(i.DOM.get("#J_TSiteNav")||g){o.Global._initLoginStatus();if(g&&s.needMemberInfoMobile||!g){o.Global._initMemberInfo()}}if(!j&&C["mui/globalmodule/global-mod"]){i.use("mui/globalmodule/global-mod")}})})}if(i){TB.add("mod~global",o)}else{TB.add("mod~global",function(){});o()}})(window,document,KISSY,TB);