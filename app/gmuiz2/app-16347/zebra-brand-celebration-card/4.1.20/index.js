define("mui/zebra-brand-celebration-card/index",function(e,t,a){var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,a,i){if(a)e(t.prototype,a);if(i)e(t,i);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}e("mui/kissy-polyfill/index");var r=e("mui/zepto/zepto");var o=e("./mods/cards.tpl");var l=e("mui/tmall-coupon/index");var s=e("mui/crossimage/index");var d=e("mui/datalazyload/index").instance();var u=e("mui/datalazylist/index");var c=e("mui/datalazylist/render/node");var f=e("mui/datalazylist/loader/page");var h=e("mui/tb-video-player4/index");var m=e("mui/mtop/index");m.config.prefix="api";m.config.subDomain=!~location.hostname.search("^(pre-wormhole|zebra)")?"m":"wapa";m.config.mainDomain="tmall.com";var v=function(){function e(t,a){n(this,e);this.$el=r(t);Object.assign(this,a);this.init()}i(e,[{key:"init",value:function t(){d.addStartListener(s.DatalazyPlugin(this.$el[0]));var e=z();this.sellerId=Number(e.sellerId)||0;this.initList()}},{key:"initList",value:function a(){this.hasMore=true;var e=this,t=new u({render:new c({el:e.$el.find(".card-list")[0],groupSize:2,renderBuffer:document.documentElement.clientHeight*1.1,destroyBuffer:document.documentElement.clientHeight*2.2,createDom:function a(t){t.isStarted=e.isStarted;t.iconImg=e.iconImg;return r(o(t))[0]},initDom:function i(e){d.addElements(e.el)}}),loader:new f({preloadNum:1,onData:function n(t,a){if(e.hasMore){e.fetchData(t.page+1,a)}else{a([])}}})});this.initVideo()}},{key:"fetchData",value:function l(e,t){var a=this;var i={stage:this.isStarted?0:1,pageSize:10,sellerId:this.sellerId,pageNo:e};var n=location.search.match(/[?&]itemId(=([^&#]*)|&|#|$)/);var r=n&&n[2];if(r){i.itemId=r}m.request({api:"mtop.taobao.shopsell.service.getBrands",v:"1.0",ecode:0,data:i}).then(function(i){a.parse(i.data);if(e===1){var n=i.data&&i.data.total||i.data&&i.data.resultValue&&i.data.resultValue.length||0;if(n){a.$el.find(".cards-subtitle span").text(n)}else{a.$el.find(".cards-subtitle").hide();a.$el.find(".cards-title").hide()}a.$el.find(".card-list").css("min-height",0)}a.hasMore=i.data&&i.data.extraInfo&&(i.data.extraInfo.hasMore==="true"||i.data.extraInfo.hasMore===true);t(i.data.resultValue)},function(i){a.hasMore=false;t([]);if(e===1){a.$el.empty()}})}},{key:"parse",value:function v(e){var t=(new Date).valueOf();r.each(e.resultValue,function(e,a){a.videoUrl=(a.videoUrl||"").replace(/^(https:)?\/\//,"http://");a.diff=x(a.targetTime-t)})}},{key:"initVideo",value:function g(){var e=this;new h({});this.$el.on("click",".j_ReceiveCoupon,.J_actVideo",function(t){var a=r(t.currentTarget);if(a.is(".J_actVideo")){if(e.isStarted){p("/new.1129.11","H46777383")}else{p("/new.1129.13","H46777406")}}else if(a.is(".j_ReceiveCoupon")){if(e.isStarted){p("/new.1129.14","H46777407")}else{p("/new.1129.12","H46777405")}}})}}]);return e}();function p(e,t){window.goldlog&&window.goldlog.record(e,"","",t)}var g=24*60*60*1e3,w=60*60*1e3,y=60*1e3,b=1e3;function x(e){if(e<0){e=0}return{dd:(e/g|0)+1,hh:e/w|0,mm:e%w/y|0,ss:e%w%y/b|0}}function z(){var e={},t=window.location.search.replace("?","");t=t.split("&");r.each(t,function(t,a){var i=a.split("=");if(i.length>1){e[i[0]]=i[1]}});return e}a.exports=function(e,t){try{t=JSON.parse(t)}catch(a){t={}}d.addCallback(e,function(){new v(e,t)})}});