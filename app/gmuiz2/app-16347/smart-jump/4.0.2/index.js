define("mui/smart-jump/index",function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(t,i,a){if(i)e(t.prototype,i);if(a)e(t,a);return t}}();function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}e("mui/smart-jump/index.css");var n=e("mui/zepto/touch"),r=e("mui/fetch/jsonp"),l=window,s=document;var u=function T(){var e={};var t=location.search.slice(1).split("&");if(t.length){for(var i=0;i<t.length;i++){if(t[i]&&t[i].indexOf("=")!=-1){var a=t[i].split("=");e[a[0]]=a[1]}}}return e},c=u();var d={url:"//equity-vip.tmall.com/liuliangbao/track.do",wait_time:"1500"};var f=navigator.userAgent||"",p=f.indexOf("AliApp(TM/")>=0,m=f.indexOf("AliApp")>=0||c.ttid&&c.ttid.indexOf("@juhuasuan")>=0,_=f.indexOf("AliApp(JU/")>=0,v=f.indexOf("AlipayClient")>=0,h=f.indexOf("AliApp(TB/")>=0,g=f.indexOf("AliTrip")>=0,k=f.indexOf("AliApp(BC")>=0,b=document.referrer&&document.referrer.indexOf("taobao.com")>=0,w=l.location.href.indexOf("ali_trackid=")>=0||s.cookie.match(/(?:^|\s)tkmb=([^;]+)(?:;|$)/),y=b&&!w,x=f.match(/Chrome/i)!=null&&f.match(/Version\/\d+\.\d+(\.\d+)?\sChrome\//i)!=null;var U=window.g_config||{},B=U.sbConfig||{};window.SB=window.SB||{};var A=SB.sbApiConfig={};A.callbacks=[];A.objects=[];SB.getAPIData=function(e,t){A.objects.push(e);A.callbacks.push(t);if(A.sent){if(A.data){var i=A.data,a=A.objects;var o=true;var n=false;var l=undefined;try{for(var s=A.callbacks[Symbol.iterator](),u;!(o=(u=s.next()).done);o=true){var c=u.value;if(typeof c=="function"){c.call(a[index],i)}}}catch(f){n=true;l=f}finally{try{if(!o&&s.return){s.return()}}finally{if(n){throw l}}}A.callbacks=[];A.objects=[]}}else{A.sent=true;r(d.url,{method:"jsonp",callback:"_sbCallback"}).then(function(e){return e.json()}).then(function(e){A.data=e;var t=A.objects;A.callbacks.forEach(function(i,a){if(typeof i=="function"){i.call(t[a],e)}});A.callbacks=[];A.objects=[]})}};var S=function(){function e(t){o(this,e);this.init(t)}a(e,[{key:"init",value:function t(e){var t=this;e.mmstat=e.mmstat||e.type||"default";if(!e.UIType){e.UIType="default"}t.opt=e;var i=window.g_config||{};if(i.removeSmartBanner){return}if(!e.notNeedUI&&!t._defaultHideScene()){SB.getAPIData(t,t._initSmartBanner)}}},{key:"appJump",value:function i(e){var t=this,i=Object.assign(t.opt,e);i.utsk="third";t._call({url:t._spliceUrl(i)})}},{key:"_defaultHideScene",value:function r(){var e=navigator.userAgent.indexOf("MI PAD")>=0,t=f.indexOf("ipad")>-1,i=p||e||t;return i}},{key:"_initSmartBanner",value:function l(e){var t=this;if(!e.delta){return}var i=JSON.parse(e.delta);t.track=e.track;if(t.track){t.opt.scene="liuliangbao"}t._initDefaultEvent();t._autoApp(i);t._renderDom(i)}},{key:"_autoApp",value:function u(e){var t=this,i=t.opt;var a={};i.utsk="auto";t.autoUrl=t._spliceUrl(i);var o=false;if(e&&e.data&&e.data[0]){a=e.data[0];if(a.bottom_auto=="true"&&i.UIType=="default"){o=true}else if(a.box_auto=="true"&&i.UIType=="box"){o=true}else if(a.button_auto=="true"&&i.UIType=="button"){o=true}if(o&&!window.SB.auto){if(t._autoHideScene(i.UIType,a)){return}window.SB.auto=true;if(a.click_default_url&&i.UIType=="default"){t.autoLink=t._spliceUrl({utsk:"auto",type:"link",params:{url:a.auto_default_url}})}if(a.click_box_url&&i.UIType=="box"){t.autoLink=t._spliceUrl({utsk:"auto",type:"link",params:{url:a.auto_box_url}})}t._call({url:t.autoLink||t.autoUrl,isAuto:true})}}}},{key:"_autoHideScene",value:function c(e,t){t=t||{};function i(i){var a=void 0,o=void 0;if(e=="default"&&t["auto_open_default_"+i]=="true"){a=true}else if(e=="box"&&t["auto_open_box_"+i]=="true"){o=true}return!(a||o)}var a=void 0,o=void 0,n=void 0,r=void 0,l=void 0,s=void 0,u=void 0,c=void 0,d=void 0;a=h&&i("tb");o=v&&i("pay");n=_&&i("ju");r=k&&i("bc");l=y&&i("refer");s=w&&i("tbk");u=x&&t.auto_close_andriodWeb=="true";d=t.auto_hide_ua||"HTAO|HTao|alihealthclient|AliHealthClient|ALICAR|Car|AliTrip|AliApp\\(IS";!!d&&(c=f.match(new RegExp(d))!=null);var p=a||o||n||r||l||s||c||B.hideAuto||u;return p}},{key:"_renderDom",value:function b(e){var t=this,i=t.opt;var a='<div id="J_BottomSmartBanner" class="mui-bottom-smart-banner">'+'<a id="J_BottomSmartBannerLink"><img src="{content}"></a>'+'<div class="mui-bottom-m-sb-btn-close" id="J_BottomSmartBannerClose" ></div>'+"</div>";var o=['<div class="mui-sb-box">','<div class="close" id="J_SBBoxClose"></div>','<img class="logo" src="{logo_pic}" width="42" height="42"/>','<div class="words">{pic_words}</div>','<div class="arrow"></div>',"</div>"].join("");var r={},l="";i.utsk="click";t.sbUrl=t._spliceUrl(i);if(e&&e.data&&e.data[0]){var s=function c(e,t){var i=/\\?\{([^{}]+)\}/g;if(typeof e!=="string"||!t){return e}return e.replace(i,function(e,i){if(e.charAt(0)==="\\"){return e.slice(1)}return t[i]===undefined?"":t[i]})};r=e.data[0];if(i.UIType=="box"&&r.p_cookie_set=="true"){i.setCookie=true}else if(i.UIType=="default"&&r.b_cookie_set=="true"){i.setCookie=true}if(i.img){r.content=i.img}if(!r.logo_pic){r.logo_pic="//img.alicdn.com/tps/TB1twKDJFXXXXbtXVXXXXXXXXXX-92-92.png"}if(r.click_default_url&&i.UIType=="default"){t.sbLink=t._spliceUrl({utsk:"click",type:"link",params:{url:r.click_default_url}})}if(r.click_box_url&&i.UIType=="box"){t.sbLink=t._spliceUrl({utsk:"click",type:"link",params:{url:r.click_box_url}})}if(t._showHideScene(i.UIType,r)){return}if(i.UIType=="default"){l=s(a,r);if(n("#J_BottomSmartBanner").length>0){return}if(!n("body")){setTimeout(function(){n("body").append(l)},0)}else{n("body").append(l)}u()}else if(i.UIType=="box"){n(i.triggle).append(s(o,r));!!i.showCallback&&i.showCallback();u()}!!r.exposureParam&&((new Image).src=r.exposureParam+"&r"+ +new Date+"=1");t._initSBEvent()}function u(){t._sendLog({string:"tmwap.1.3",apuri:"sb_show"})}}},{key:"_initSBEvent",value:function U(){var e=this,t=e.opt,i=t.triggle?t.triggle:"#J_BottomSmartBanner",a="";if(t.UIType=="default"){a="J_BottomSmartBannerClose"}else if(t.UIType=="box"){a="J_SBBoxClose"}n(document).on("tap",i,function(t){if(t.target.id!=a){e._call({url:e.sbLink||e.sbUrl,isClick:true})}return false});if(a){n(document).on("tap","#"+a,function(a){e._sendLog({string:"tmwap.1.4",apuri:"sb_click_close"});n(i).hide();!!t.closeBtnCallback&&t.closeBtnCallback();return false});n(document).on("touchstart","#"+a,function(e){e.preventDefault();e.stopPropagation();return false})}}},{key:"hide",value:function A(){var e=this,t=e.opt,i=t.triggle?t.triggle:"#J_BottomSmartBanner",a=n(i);!!a&&n(a).hide()}},{key:"show",value:function S(){var e=this,t=e.opt,i=t.triggle?t.triggle:"#J_BottomSmartBanner",a=n(i);!!a&&n(a).show()}},{key:"_showHideScene",value:function T(e,t){t=t||{};function i(i,a){var o=void 0,n=void 0;if(!a){if(e=="default"&&t["show_open_default_"+i]=="true"){o=true}else if(e=="box"&&t["show_open_box_"+i]=="true"){n=true}}else{if(e=="default"&&t["show_close_default_"+i]=="false"){o=true}else if(e=="box"&&t["show_close_box_"+i]=="false"){n=true}}return!(o||n)}var a=void 0,o=void 0,n=void 0,r=void 0,l=void 0,s=void 0;var u=window.innerWidth&&window.innerWidth>window.innerHeight||false;var c=u;a=h&&i("tb");o=_&&i("ju");n=y&&i("refer");r=w&&i("tbk","close");s=t.show_hide_ua||"alihealthclient|AliHealthClient|AliApp\\(IS";if(s){l=f.match(new RegExp(s))!=null}var d=a||o||n||r||l||c||B.hideShow;return d}},{key:"_spliceUrl",value:function C(e){var t=this,i=e.type||"",a=e.params||"",o="",n="";if(i){switch(i){case"detail":t.page="detail";o="tmall://page.tm/itemDetail?"+t._param(a);break;case"shop":t.page="shop";o="tmall://page.tm/shop?"+t._param(a);break;case"list":t.page="list";o="tmall://page.tm/search?searchType=item&"+t._param(a);break;case"internal":if(a.page){t.page=a.page;o=" tmall://page.tm/"+a.page+(a.params?"?"+t._param(a.params):"")}else if(a.url){o=a.url}break;case"link":t.page="h5";o=a.url;if(o.indexOf("#")>-1){o=o.replace(/#(.*?)$/,"")}o="tmall://page.tm/webview?url="+encodeURIComponent(o);break;default:o="tmall://tab.switch/home";break}}else{o="tmall://tab.switch/home"}if(t._getTkmd()){o+=(o.indexOf("?")>-1?"&":"?")+t._getTkmd()}if(t.track){o+=(o.indexOf("?")>-1?"&":"?")+t.track}var r=t._spliceUtsk();o+=(o.indexOf("?")>-1?"&":"?")+r;return o}},{key:"_getTkmd",value:function I(){var e=s.cookie.match(/(?:^|\s)tkmb=([^;]+)(?:;|$)/),t="";if(e){var i=e[1],a=/(?:^|&)e=(.*?)(?:&|$)/.test(i)?encodeURIComponent(RegExp.$1):"",o=/(?:^|&)tkFlag=(.*?)(?:&|$)/.test(i)?encodeURIComponent(RegExp.$1):"";t="e="+a+"&type=2&tkFlag="+o}return t}},{key:"_spliceUtsk",value:function L(){var e=this,t=e.opt,i={a:t.utskA||"3",b:+new Date,c:e._getUtskC(),d:(t.utsk?t.utsk+"-":"third-")+t.mmstat+"-"+(w?"1":"0")};return"_ns=1&ut_sk="+i.a+"."+i.b+"."+i.c+"."+i.d}},{key:"_getUtskC",value:function O(){var e="other",t=f.indexOf("Weibo")>=0,i=f.indexOf("UCBrowser")>=0&&!m,a=f.indexOf("QQBrowser")>=0;if(h){e="tb"}else if(_){e="ju"}else if(v){e="alipay"}else if(g){e="alitrip"}else if(t){e="weibo"}else if(i){e="uc"}else if(a){e="qq"}else if(k){e="bc"}else if(m){e="aliapp"}return e}},{key:"_judgePlatform",value:function j(){var e=this,t=navigator.standalone;if(f.match(/iPhone|iPod|iPad/i)!=null){e.platform="ios";e.isIpad=f.match(/iPad/i)!=null}else if(f.match(/Android/i)!=null){if(f.match(/Mobile/i)!=null){e.platform="android";e.isChrome=f.match(/Chrome/i)!=null&&f.match(/Version\/\d+\.\d+(\.\d+)?\sChrome\//i)==null}}else if(f.match(/Linux/i)!=null){e.platform="android"}if(!e.platform||t){e.invaliable=true;return false}return true}},{key:"_initDefaultEvent",value:function D(){var e=this;window.addEventListener("blur",function(){if(!e.timeload)return;clearTimeout(e.timeload);e.timeload=null});document.addEventListener("visibilitychange",function(){if(document.hidden){if(!e.timeload)return;clearTimeout(e.timeload);e.timeload=null}})}},{key:"_call",value:function X(e){var t=this,i=t.opt,a=Date.now();if(!t._judgePlatform()){return}if(e.isAuto){t._sendLog({string:"tmallacti.201503.1005.5",apuri:"sb_auto_envoke"});if(t.platform=="ios"){t._sendLog({string:"tmallacti.201503.1005.1",apuri:"sb_ios_auto_envoke"})}else{t._sendLog({string:"tmallacti.201503.1005.3",apuri:"sb_andriod_auto_envoke"})}}else{t._sendLog({string:"tmwap.1.8",apuri:"sb_click"});if(t.platform=="ios"){t._sendLog({string:"tmwap.1.5",apuri:"sb_ios_click"})}else{t._sendLog({string:"tmwap.1.6",apuri:"sb_andriod_click"})}}if(t.timeload){clearTimeout(t.timeload)}t.timeload=setTimeout(function(){var o=Date.now();clearTimeout(t.timeload);t.timeload=null;if(o-a<d.wait_time+50){if(e.isAuto){if(t.platform=="ios"){t._sendLog({string:"tmallacti.201503.1005.2",apuri:"sb_ios_auto_fail"})}else{t._sendLog({string:"tmallacti.201503.1005.4",apuri:"sb_andriod_auto_fail"})}}else{if(t.platform=="ios"){t._sendLog({string:"tmwap.1.2",apuri:"sb_ios_click_fail"})}else{t._sendLog({string:"tmwap.1.7",apuri:"sb_andriod_click_fail"})}}!!i.fail&&i.fail();if(!(i.notGoDownload||e.isAuto)){t._download()}}else{!!i.success&&i.success()}},d.wait_time);t._redirect(e)}},{key:"_redirect",value:function J(e){var t=this,i=e.url||"",a=[],o="";if(f.match(/(iPhone)/)){if(f.match(/Safari/)){a=f.match(/Version\/([\d\.]+)/);if(a){o=a[1];o&&(o=o.split(".")[0])}}}if(o>=9){window.location.href=i}else if(t.isChrome){var n=i.split("://"),r=n[0],l=i.replace(r+"://","");i="intent://"+l+"#Intent;scheme="+r+";package=com.tmall.wireless;end";var s=window.open(i);if(e.isClick){s.location.href="http://m.laiwang.com/market/laiwang/tmall/app-download.php?src="+(opt.downloadSrc?opt.downloadSrc:"wapicon")}}else{(function(){var e=document.createElement("iframe");e.style.display="none";e.src=i;if(!document.body){setTimeout(function(){document.body.appendChild(e)},0)}else{document.body.appendChild(e)}})()}}},{key:"_download",value:function P(){var e=this,t=e.opt,i="";if(e.platform=="ios"){i=e.isIpad?"https://itunes.apple.com/app/id593828513":"http://itunes.apple.com/cn/app/id518966501?mt=8"}else{i="http://m.laiwang.com/market/laiwang/tmall/app-download.php?src="+(t.downloadSrc?t.downloadSrc:"wapicon")}window.location.href=i}},{key:"_sendLog",value:function E(e){var t=this,i=t.opt,a="",o={};if(!e||!e.string){return}e.apuri&&(o["apuri"]=e.apuri);i.scene&&(o["scene"]=i.scene);i.mmstat&&(o["mmstat"]=i.mmstat);o["ui"]=i.UIType?i.UIType:"";o["r"]=+new Date;var n=[];for(var r in o){n.push(r+"="+encodeURIComponent(o[r]))}a="//wgo.mmstat.com/"+e.string+"?"+n.join("&");(new Image).src=a}}]);return e}();i.exports=S});