var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(t,n,r){if(n)e(t.prototype,n);if(r)e(t,r);return t}}();function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}(function(e,t){var n=void 0;var r=function(){function n(e){_classCallCheck(this,n);this.opt={};this.opt.diff=e||50}_createClass(n,[{key:"init",value:function r(){this.opt=this.opt||{};this.opt.Req=require;this.opt.loader=feloader||KISSY;this.opt.plugins=e.$zebra.plugins||{};this.opt.mods={};this.polyfill();this.scanMods()}},{key:"polyfill",value:function o(){var e=this.opt.loader;function n(e){var n=false;function r(){if(n)return;n=true;e()}if(t.addEventListener){t.addEventListener("DOMContentLoaded",r,false)}else if(t.attachEvent){var i=false;try{i=window.frameElement!==null}catch(o){}if(t.documentElement.doScroll&&!i){(function a(){if(n)return;try{t.documentElement.doScroll("left");r()}catch(e){setTimeout(a,10)}})()}t.attachEvent("onreadystatechange",function(){t.readyState==="complete"&&r()})}}e.ready=e.ready||n}},{key:"scanMods",value:function a(){var e=this;var r=this.opt;var i=r.loader;var o=r.mods;var a=r.diff;var l=[],s=i.ready;o={sync:[],async:[],ignore:[]};s(function(){if(t.querySelectorAll){l=document.querySelectorAll("[data-mod-name]")}else{var r=document.getElementsByTagName("*");for(var i=0,s=r.length;i<s;i++){if(r[i]&&r[i].getAttribute("data-mod-name")){l.push(r[i])}}}if(!l.length)return;var c="",u=void 0;for(var f=0,d=l.length;f<d;f++){c=l[f].getAttribute("data-zebra-load");u={mod:l[f].getAttribute("data-mod-name"),el:l[f],cfg:l[f].getAttribute("data-config")};if(n.isHiddenMod(l[f])){o.sync.push(u);continue}if(c==="ignore"){o.ignore.push(u)}else if(c==="async"||l[f].getAttribute("data-async-load")||!n.isInViewport(l[f],a)&&c!=="sync"){o.async.push(u)}else if(c==="sync"||n.isInViewport(l[f],a)){o.sync.push(u)}}e.opt.mods=o;e.initMods()})}},{key:"initMods",value:function l(){var e=this.opt;var t=e.Req;var n=e.mods;var r=this.filterEnabledPlugins();if(r.indexOf("mui/zebra-loader/plugins/asyncload")<0){n.sync=n.sync.concat(n.async);n.async=[]}if(r.length){t(r,function o(){var e=Array.prototype.slice.call(arguments);var t=void 0;for(var r=0,i=e.length;r<i;r++){t=new e[r](n);t.init()}},function a(){})}new i(n).init()}},{key:"filterEnabledPlugins",value:function s(){var e=this.opt.plugins;var t=[];for(var n in e){if(e.hasOwnProperty(n)&&e[n]===true){t.push("mui/zebra-loader/plugins/"+n)}}return t}}],[{key:"isHiddenMod",value:function c(e){var t=void 0;if(window.getComputedStyle){t=window.getComputedStyle(e)}else{t=e.currentStyle}return t["display"]==="none"||t["height"]==="0px"&&t["width"]==="0px"}},{key:"isInViewport",value:function u(e,t){var n=e.getBoundingClientRect();return!(!n.width&&!n.height||n.top-window.innerHeight>=t||n.bottom+t<=0||n.right<=0||n.left-window.innerWidth>=0)}}]);return n}();var i=function(){function e(t){_classCallCheck(this,e);this.opt={};this.opt.mods=t.sync;this.opt.Req=require}_createClass(e,[{key:"init",value:function t(){this.load()}},{key:"load",value:function n(){var t=this.opt;var n=t.mods;var r=t.Req;var i=n,o=[];for(var a=0,l=i.length;a<l;a++){o.push(i[a].mod)}r(o,function s(){var t=Array.prototype.slice.call(arguments);var n=void 0,r=void 0;for(var a=0,l=t.length;a<l;a++){n=t[a];r=i[a];if(e.isFunction(n)){if(e.isDebug()){n(r.el,r.cfg)}else{try{n(r.el,r.cfg)}catch(s){console&&console.error(s);if(!e.isLteIE7()){codeTrack("error:loader.jsError","zebra-loader.init",{msg:"\u7ec4\u4ef6: "+o[a]+"\u5185\u90e8\u5b58\u5728\u963b\u585e\u811a\u672c\u9519\u8bef,\u9519\u8bef\u4e3a\uff1a"+s})}}}}}},this.backupLoad.bind(this))}},{key:"backupLoad",value:function r(){var t=this;var n=this.opt;var r=n.mods;var i=n.Req;var o=r;var a=function c(n,r){i(o[n].mod,function(t){if(e.isFunction(t)){t(o[n].el,o[n].cfg)}},function(){t.reportError(o[n].mod+"\u7ec4\u4ef6\u81ea\u8eab\u811a\u672c\u6216\u8005require\u4f9d\u8d56\u8d44\u6e90\u4e0d\u5b58\u5728\uff0c\u4e3a\u4e86\u907f\u514d\u95ee\u9898\u5f53\u524d\u8282\u70b9\u5df2\u9690\u85cf");o[n].el&&(o[n].el.style.display="none")})};for(var l=0,s=o.length;l<s;l++){a(l,s)}}},{key:"reportError",value:function i(t){t=typeof t=="string"?t:"\u6709\u7ec4\u4ef6\u4e0d\u5b58\u5728\uff0c\u65e0\u6cd5\u52a0\u8f7d";console&&console.error(t);if(!e.isLteIE7()){codeTrack("error:loader.loaderError","zebra-loader.init",{msg:"\u7ec4\u4ef6\u8bf7\u6c42\u5931\u8d25\uff1a"+t})}}}],[{key:"isLteIE7",value:function o(){var e=navigator.userAgent.toLowerCase().match(/msie ([\d.]+)/),t=false;if(e&&e[1]&&(e[1]=="6.0"||e[1]=="7.0")){t=true}return t}},{key:"isDebug",value:function a(){return location.href.indexOf("wh_debugger")>0&&location.href.indexOf("?")>0}},{key:"isFunction",value:function l(e){return Object.prototype.toString.call(e)==="[object Function]"}}]);return e}();function o(){e.$zebra=e.$zebra||{};if(!e.$zebra._isLoaded){n=new r(e.$zebra.diff);n.init()}}o()})(window,document);