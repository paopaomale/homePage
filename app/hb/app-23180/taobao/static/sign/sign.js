webpackJsonp([2],{0:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}a(100),a(117);var r=a(62),s=i(r),n=a(215),d=i(n),c=a(74),l=i(c),o=a(1),u=i(o),m=a(189),f=i(m),v=a(43),p=i(v),g=a(11),b=i(g),h=a(72),y=i(h),k=a(9),w=i(k),S=a(41),A=i(S),C=a(14),j=i(C),T=a(23),I=i(T),O=new s["default"]({model:l["default"],view:d["default"],events:{"view:security":function(){var e=this,t=this.model.get("data"),a=this.model.get("trackerSrc")||"tbapp-index";t.redirectUrl=this.model.get("redirectUrl");var i=JSON.stringify(t);p["default"].set("resSign",i),e.signHuabeiByCTU({trackerSrc:a},function(e){e=e||{},Ali.alert({message:e.message||"\u987e\u5ba2\u592a\u591a\uff0c\u5ba2\u5b98\u8bf7\u7a0d\u5019\u518d\u8bd5"})})}},enter:function(e){var t=this;this.main=e,t.view.set(e),this.model.fetch().then(function(){var e=t.model.get("data"),a=t.model.get("pageType"),i=t.model.get("query");i.hbsrc&&u["default"].tracker(i.hbsrc+"Sign"),u["default"].calc("bizScenario",i.hbsrc),t.view.fillModel(t.model),t.preRender(e,a).then(function(a){a.shouldRender&&t.view.render(e),t.view.ready(),f["default"].statusTracker(e)})},function(e){return"limitFlow"===e.result.resultCode?void j["default"].limitFlow("#main",{title:e.result.resultView}):(t.view.fire("error",e,"sign"),void t.view.ready())})["catch"](function(e){console.error(e)})},signHuabeiByCTU:function(e,t){var a=umx&&umx.getToken();e=e||{};var i=e.trackerSrc||"",r=y["default"].callbackURLCTU+i;b["default"].request("taobao",{umidToken:a,requestType:"queryPolicy",sceneCode:"pcredit_sign_wap",productName:"pcredit",systemName:"pcreditprod",accessChannel:"app",pcreditBizCode:"HB",optRoute:"ALIPAYAPP",channelType:"MOBILE",productNode:"moonlight_sign",hbsrc:e.trackerSrc,callbackUrl:r}).then(function(t){var a=t.result.data;if(!a.verifyId)return w["default"].reject({message:"verifyId\u4e3a\u7a7a"});var i=y["default"].CTU;i+=a.verifyId,p["default"].set("verifyId",a.verifyId),p["default"].set("hbsrc",e.trackerSrc),u["default"].redirect(i)},t)["catch"](function(e){console.error(e)})},preRender:function(e,t){var a=this,i=!0,r=new I["default"];switch(t){case"signed":u["default"].tracker("loadSigned"),u["default"].redirect("index.htm");break;case"admit":case"trialSign":return a.admit=u["default"].bind(a.admit,a,e,t),a.getCdp(r,i),r.promise;case"noAdmit":this.view.noAdmit(e),u["default"].tracker("noAdmit"),i=!1,r.resolve({shouldRender:i});break;default:this.view.noAdmit(e),u["default"].tracker("signError"),i=!1,r.resolve({shouldRender:i})}return r.promise},admit:function(e,t){var a=this,i=this.model.get("trackerSrc")||"unknown";a.model.addCms(e),"admit"===t?(u["default"].tracker("loadAdmit"),u["default"].tracker("loadAdmit"+i)):"trialSign"===t?(e.isTriaSign=!0,u["default"].tracker("trialSign"),u["default"].tracker("trialSign"+i)):"scan_face"===t?u["default"].tracker("loadScanFace"):"real_name"===t&&(a.model.addCmsForTrialCertify(e),u["default"].tracker("loadPreAdmit"))},getCdp:function(e,t){var a=this,i="/h5/signConfig.vm",r=this.model.get("data").cms||{},s=r[i]&&r[i].activeUrl;s&&!this.model.get("query").redirectUrl?A["default"].getToken({redirectUrl:s}).then(function(i){i=i||{},i.trustLoginUrl?(u["default"].tracker("signActivity"),window.location.replace(i.trustLoginUrl)):(a.admit(),e.resolve({shouldRender:t}))})["catch"](function(){a.admit(),e.resolve({shouldRender:t})}):(a.admit(),e.resolve({shouldRender:t}))}});O.enter("#main")},87:function(e,t){e.exports=function(e){return function(e,t,a){var i="";return e?i+='<div class="error-box"> <div class="message"> <div class="icon icon-no-admit"></div> <div class="desc-box desc-noAdmit"> <h2>\u4f60\u6682\u65f6\u65e0\u6cd5\u4f7f\u7528\u82b1\u5457</h2> <p class="explan">\u4f60\u7684\u5173\u6ce8\u5bf9\u6211\u4eec\u5f88\u91cd\u8981\uff0c\u4f60\u53ef\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u63d0\u5347\u83b7\u5f97\u82b1\u5457\u7684\u53ef\u80fd\u6027\uff1a</p> <p>1\u3001\u591a\u4f7f\u7528\u8be5\u8d26\u6237\u6d88\u8d39</p> <p>2\u3001\u591a\u4f7f\u7528\u652f\u4ed8\u5b9d\u4e3a\u4fe1\u7528\u5361\u8fd8\u6b3e\u6216\u8fdb\u884c\u6c34\u7535\u7164\u7f34\u8d39 </p> <p>3\u3001\u591a\u4e0e\u652f\u4ed8\u5b9d\u597d\u53cb\u4e92\u52a8</p> </div> <div class="button"> <a href="javascript:;" data-btn="back" class="ui-ygb-button J_ResultButton">\u8fd4\u56de</a> </div> </div></div>':"sign"===t?(i+='<div class="error-box"> <div class="hd-bg"></div> <div class="message"> <div class="icon icon-error"> </div> <div class="desc-box"> ',a&&(i+=' <p class="explan">',i+=a,i+="</p> "),i+=' </div> <div class="button"> <a href="javascript:;" data-btn="back" class="ui-ygb-button J_ResultButton">\u8fd4\u56de</a> </div> </div></div>'):(i+='<div class="am-page-result"> <div class="am-page-result-wrap"> <div class="am-page-result-pic am-icon" am-mode="am-page-loading"></div> <div class="am-page-result-title">',i+=a,i+='</div> <div class="am-page-result-brief"></div> <div class="am-page-result-button"> <button class="am-button J_ResultButton" data-btn="back" am-mode="white">\u8fd4\u56de</button> </div> </div></div>'),i}(e.defaultMsg,e.errorType,e.message)}},93:function(e,t){e.exports='<!--target:sign--> <!--if:{{cmsObj.activityStyle}}--> <style>{{cmsObj.activityStyle|raw}}</style> <!--/if--> <!--if:{{cmsObj.biuOpen}} === \'off\'--> <div class="sign-biu-off"> <!--else--> <div> <!--/if--> <!--if: {{cmsObj.headerImg}}--> <header class="sign-header" style="background-image: url(\'{{cmsObj.headerImg}}\')"><!--else--> <header class="sign-header"><!--/if--> <article class="sign-header-cnt"> <!--if:{{trial}} || {{preAdmitType}}--> <p class="title-trial">\u4f53\u9a8c\u65b0\u751f\u6d3b</p> <!--else--> <p class="title">\u4f60\u7684\u8682\u8681\u82b1\u5457\u989d\u5ea6</p> <p class="amount" data-seed="hb-sign-amount"><strong class="num">{{creditAmt|formatMoney}}</strong></p> <!--/if--> <!--if: !({{cmsObj.isActivity}} && {{trial}})--> <p class="explain">\u53ef\u7528\u4e8e\u6dd8\u5b9d\u3001\u5929\u732b\u7b49\u8d2d\u7269\u7f51\u7ad9\u53ca\u7ebf\u4e0b\u6d88\u8d39</p> <!--/if--> </article> </header> <!--if: {{cmsObj.isActivity}}--> <!--var: bannerImg= {{cmsObj.bannerImgActivity}}--> <!--else--> <!--var: bannerImg= {{cmsObj.bannerImg}}--> <!--/if--> <a class="sign-banner" data-seed="hb-sign-advantage" data-url="{{cmsObj.bannerUrl}}" style="background-image: url(\'{{bannerImg}}\')"></a> <div class="sign-body am-wingblank" am-mode="25px"> <!--if: {{preAdmitType}} === "real_name"--> <div class="sign-desc">{{cmsObj.SIGN_DESC|raw}}</div> <!--/if--> <button seed="hb-s" class="am-button J_confirm" am-mode="middle">{{cmsObj.BTN_TEXT}}</button> <div class="text" seed="hb-sign-contact">{{cmsObj.SIGN_PROTOCOL|raw}}</div> </div> <div class="biu-content"> <div class="ui-divider"> <div class="ui-divider-line"></div> </div> <div class="biu-wrap" id="J_biu"> </div> </div> <footer class="sign-footer"> <p class="brief">{{cmsObj.SIGN_COPYRIGHT}}</p> </footer> </header></div> <!--/target--> </div>'},100:function(e,t,a){e.exports=a.p+"sign.htm"},117:110,189:function(e,t,a){"use strict";var i=a(1),r=!1,s="alipay.com",n=location.href.indexOf("alipay.net")!==-1;n&&(r=location.href.indexOf("test.")!==-1,s=r?"test.alipay.net":"stable.alipay.net");var d=location.protocol+"//promoprod."+s,c={urls:{lottery:d+"/campaign/campaign.json",record:d+"/query/lotteryNumber.json",signCert:d+"/campaign/signCert.json",queryPrize:d+"/query/prizeDrawnInCampaign.json",queryRemainPirze:d+"/query/queryRemainPirzeCount.json",queryUserCertInfo:d+"/query/userCertInfo.json"},campInfoID:"",campCode:"",lotNumber:""};e.exports={statusTracker:function(e){e.admit&&!e.trial&&i.calc("pageStatus","admit"),e.admit&&e.trial&&i.calc("pageStatus","trialSign"),e.preAdmitType&&!e.trial&&i.calc("pageStatus","preAdmit"),e.preAdmitType&&e.trial&&i.calc("pageStatus","trialPreAdmit")},getSignCert:function(e,t,a){$.ajax({url:c.urls.signCert,data:e,dataType:"jsonp",jsonp:"_callback",success:function(e){t&&t(e)},error:function(e){a&&a(e)}})}}},215:function(e,t,a){"use strict";a(6);var i=a(73),r=a(39),s=a(1),n=a(87);e.exports={constructor:i,template:a(93),domEvents:{"click:.J_confirm":function(){this.emit("security")},"tap:.J_Protocol":function(){var e=r.get("protocol");Ali.utils.isAndroid?location.href=e:Ali.pushWindow({url:e}),s.tracker("exhb-identify-contact")},"tap:[data-btn=back]":function(){Ali.closeWindow()}},noAdmit:function(e){$(document.documentElement).addClass("root-error"),this.main.addClass("page-wrap");var t={message:e.message||"\u7cfb\u7edf\u51fa\u9519\u5566\uff01",errorType:"sign",defaultMsg:"\u4e0d\u51c6\u5165"};this.main.html(n(t))}}}});