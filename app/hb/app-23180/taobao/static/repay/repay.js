webpackJsonp([7],{0:function(e,t,n){"use strict";n(99),n(6);var a=n(30);n(116);var r=window,o=r.common,i=o.io,u=o.page,c=o.url,s=o.keyboard,l=$("#J_RefundTip"),p=$("#J_Money"),d=$("#J_SubmitBtn"),f=$("#J_Index"),h={},y="",b="\u7cfb\u7edf\u51fa\u73b0\u5f02\u5e38,\u8bf7\u7a0d\u540e\u91cd\u8bd5",m={init:function(){var e=this,t=new Date;this.fetch().then(function(n){Tracker.calc("renderRepay",new Date-t);var a=n.result||{},r=a.data||{};a.success?e.fetchSuccess(r):e.fetchError()},function(){e.fetchError()})["catch"](function(){e.fetchError()})},fetch:function(){return i.request("taobao",{requestType:"renderRepay",year:c.getQuery().year,month:c.getQuery().month})},fetchSuccess:function(e){var t=this;f.show(),h=e,t.render(e),t.bindEvent(),y=t.packTip(e),t.valid(!0)},fetchError:function(){u.error(),f.show()},render:function(e){var t=e.defaultAmount||"";p.val(t),l.html(y)},bindEvent:function(){var e=this;d.on("tap",function(){e.valid(),e.submitRefund()}),p.on("input",function(){e.valid()}),new s({trigger:p,onClear:function(t){e.valid(t)}}),Ali.on("back",function(){p.blur(),setTimeout(function(){Ali.popWindow()},200)})},packTip:function(e){var t=e.repayType,n=e.curAmount,a=e.defaultAmount,r=e.historyUnclearMonthCount,o=e.penalty,i=e.repayNextAmount,u="";if("REPAY_BILLED"===t)if(r>0||parseFloat(o,0)>0){var c=!1;r>0&&parseFloat(o,0)>0&&(c=!0);var s=[];s.push("\u672c\u6708\u5e94\u8fd8"+a+"\u5143"),s.push("("),r>0&&s.push("\u542b\u5386\u53f2\u903e\u671f\u8d26\u5355"),c&&s.push(","),parseFloat(o,0)>0&&s.push("\u903e\u671f\u5229\u606f"+o+"\u5143"),s.push(")"),u=s.join("")}else u="\u672c\u6708\u5e94\u8fd8"+a+"\u5143";else u="REPAY_NEXT"===t?parseFloat(n)>0?"\u5e94\u8fd8"+a+"\uff08\u542b\u672c\u6708\u5e94\u8fd8"+n+"\uff09\u5143\uff0c\u4f18\u5148\u507f\u8fd8\u672c\u6708":"\u4e0b\u6708\u5e94\u8fd8"+i+"\u5143":"\u5e94\u8fd8"+a+" \u5143";return u},valid:function(e){var t=this,n=p.val(),a=/^\d+(\.\d{1,2})?$/.test(n),r=parseFloat(n),o=y,i=Number(h.minAmount),u=Number(h.maxAmount);a?r>i&&r<=u?(t.buttonEnabled(!0),t.explanSetRed(!1)):(t.buttonEnabled(!1),t.explanSetRed(!0),n&&n.length>0&&0===n&&(o="\u6700\u5c11\u8fd8\u6b3e\u91d1\u989d0.01\u5143")):(t.buttonEnabled(!1),t.explanSetRed(!0)),e&&t.explanSetRed(!1),l.html(o)},submitRefund:function(){var e=this,t={requestType:"applyRepay",repayAmount:p.val(),repayType:h.repayType,extInfo:{hbsrc:"taobao_app"}};t.repayAmount&&t.repayType?e.doRepayRequest(t):Ali.alert(b)},doRepayRequest:function(e){var t=this,n=new Date;i.request("taobao",e).then(function(e){Tracker.calc("applyRepay",new Date-n);var a=e.result||{},r=a.data||{};r.bizType&&r.tradeNo&&r.tbsid?t.tradePay(r):Ali.alert(b)},function(){Ali.alert(b)})["catch"](function(){Ali.alert(b)})},tradePay:function(e){Ali.tradePay({signStr:"biz_type="+e.bizType+"&trade_no="+e.tradeNo+"&extern_token="+e.tbsid,backURL:o.baseUrl+"payed.htm",unSuccessUrl:o.baseUrl+"index.htm"})},buttonEnabled:function(e){e?d.removeAttr("disabled"):d.attr({disabled:"disabled"})},explanSetRed:function(e){e?l.addClass("color-red"):l.removeClass("color-red")}};Ali.ready(function(){m.init(),(0,a.subscribePageRefresh)(a.SHOULD_REFRESH_PAGE.REPAY,function(){Ali.popWindow()})})},99:function(e,t,n){e.exports=n.p+"repay.htm"},116:110});