!function(){function a(){if(lib.env.os.isIPhone&&lib.env.taobaoApp){var a,b,c=document.documentElement.clientWidth;document.addEventListener("horizontalpanstart",function(b){a=b.touchEvent.touches[0].pageX},!1),document.addEventListener("horizontalpan",function(d){b=d.displacementX,a>0&&b>0&&c/10>a&&b>.3*c&&(document.removeEventListener("horizontalpan"),WindVane.call("WVNative","nativeBack",{}))},!1)}}var b={isSupportWebp:function(){window.isHasWebp=!1;var a=new Image;a.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",a.onload=function(){2===a.height?window.isHasWebp=!0:window.isHasWebp=!1},a.onerror=function(){window.isHasWebp=!1}},convertImgCdn:function(a){if(!a||"string"!=typeof a)return"";var b=["wimg.taobao.com","alicdn.com","taobaocdn.com"],c=document.createElement("a");c.href=a;for(var d=0;d<b.length;d++)if(-1!=c.host.indexOf(b[d])){c.host="gw.alicdn.com";break}return c.href},getNetWorkInfo:function(a){lib.env.taobaoApp?window.WindVane&&WindVane.call("TBDeviceInfo","getInfo",{},function(b){"wifi"!=b.network&&(window.WeakNetStatus=!0),a&&a()},function(b){a&&a()}):a&&a()},openLinkByWv:function(a){a.preventDefault();var b=a.currentTarget,c=$(a.currentTarget),d=c.attr("href"),e="",f=!0;if(d){if(lib.httpurl){var g=new lib.httpurl(d);if(window.g_SPM&&window.g_SPM.spm){var h=window.g_SPM.spm(b);g.params.spm=h}e=g.toString()}else e=d;-1!=e.indexOf("openwindow=false")&&(f=!1),lib.env&&lib.env.taobaoApp&&window.WindVane&&f?window.WindVane.call("Base","openWindow",{url:e},function(){},function(){location.href=e}):location.href=e}},getUtdid:function(a){window.localStorage&&window.localStorage.getItem("h5_app_hysc_utdid")?(window.utdid=window.localStorage.getItem("h5_app_hysc_utdid"),a&&a()):lib.env&&lib.env.taobaoApp?window.WindVane.call("TBDeviceInfo","getUtdid",{},function(b){b.utdid&&(window.utdid=b.utdid,window.localStorage&&window.localStorage.setItem("h5_app_hysc_utdid",b.utdid)),a&&a()},function(b){a&&a()}):a&&a()},initNavBar:function(){var a=$(".hytpl-navbar");a.length&&a.on("click","a",function(a){a.preventDefault();var b=$(a.currentTarget),c=b.attr("href");b.hasClass("cur")||(c&&-1==c.indexOf("http://hichao.uz.m.jaeapp.com/d/wuxian/women")&&(c=c.replace(/^(http:|https:)/,location.protocol)),window.location.replace(c))})},getUrlParams:function(){if(lib.httpurl){var a=new lib.httpurl(location.href);return a.params}return null},mtopErrorHandler:function(a){var b=this,c=a.ret[0],d=c.split("::")[0];switch(d){case"FAIL_SYS_TRAFFIC_LIMIT":b.showToast("哎哟喂，被挤爆啦，请稍后重试");break;default:b.showToast("请求数据失败")}},showToast:function(a){null!=navigator.userAgent.match(/WindVane/i)?window.WindVane.call("WVUIToast","toast",a,function(a){},function(a){console.log(JSON.stringify(a))}):console.log(a)}};window.utils=b,window.utils.getUtdid(),window.utils.isSupportWebp(),window.addEventListener("DOMContentLoaded",function(){b.initNavBar(),a()},!1)}(),function(){var a={};this.tmpl=function b(c,d){var e=/\W/.test(c)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[c]=a[c]||b(document.getElementById(c).innerHTML);return d?e(d):e}}(),function(){var a=function(){this.pageScroller=null,this.mainTabScroller=null,this.subTabScroller=null,this.cache={},this.curPage={},this.canGetMore=!1;var a=new lib.httpurl(location.href);this.initTagId=a.params.tagid?a.params.tagid:3,this.gender=a.params.gender&&"male"==a.params.gender?"male":"female",this.appendTimer=null,this.imgLib=lib.img({"class":"lib-img",size:"300x300",dataSrc:"data-src",sharpen:"s150",q:["q50","q30"],enableLazyload:!1}),this.renderTab(),this.initScroller(),this.initTag(),this.bind()};a.prototype={renderTab:function(){var a=tmpl("male"==this.gender?"male_tab_tmpl":"female_tab_tmpl",{});$(".tab-wrap").html(a)},initTag:function(){var a=$('[data-tagid="'+this.initTagId+'"]');a[0]||(a=$(".sub-tab a").eq(0)),this._clickOnMaintagA(null,a[0])},initScroller:function(){var a=this;this.pageScroller=lib.scroll({scrollWrap:document.querySelector("#J-page-scroll")}).init(),this.mainTabScroller=lib.scroll({scrollWrap:document.querySelector(".main-tab"),direction:"x"}).init(),this.pageScroller.addScrollendHandler(function(b){a.imgLib.fireLazyload()},!1)},bind:function(){var a=this;$("body").on("click",".main-tab a",function(b){b.preventDefault(),a._clickOnMaintagA(this,null)}),$("body").on("click",".sub-tab a",function(b){b.preventDefault();$(this).attr("data-tagid");$(this).parents(".sub-tab").find("a").removeClass("active"),$(this).addClass("active"),a.requestAndRender()}),lib.env.taobaoApp&&(window.WindVane.call("WebAppInterface","enableStatusBarClicked","",null,null),document.addEventListener("TBStatusBar.clicked",function(b){a.pageScroller&&a.pageScroller.scrollTo(0,!0)},!1))},_clickOnMaintagA:function(a,b){var c,d,e=this;if(b){c=$(b);var f=c.parents("ul").index();d=$(".main-tab li").removeClass("active").eq(f)}else{d=$(a).parents("li");var f=d.index();c=$(".sub-tab ul").eq(f).find("a").eq(0)}$(".main-tab li").removeClass("active"),$(".sub-tab a.active").removeClass("active"),c.addClass("active"),d.addClass("active");var g=d[0],h=e.mainTabScroller.offset(g),i=h.left,j=h.width,k=e.mainTabScroller.getViewWidth(),l=i-(k-j)/2;e.mainTabScroller.scrollTo(l,!0),e.updateSubtab(),e.requestAndRender()},updateSubtab:function(){var a=$(".main-tab li.active").index();$(".sub-tab ul").hide().eq(a).css({display:"-webkit-box"})},requestByActiveTag:function(a){var b=$(".sub-tab a.active"),c=b.attr("data-tagid"),d=this;return d.curPage[c]=1,this.cache[c]?(a&&a(this.cache[c]),this.cache[c]):void lib.mtop.request({api:"com.taobao.wireless.chanel.realTimeSearchItems",v:"1.0",data:{albumId:"MZ_ONLINE_TOP_SPU_2",pageSize:"10",currentPage:"1",param:"{tabid:"+c+"}"}},function(b){d.isDouble11=window.isDouble11(b.data.model.currentTime),d.isDouble11,d.cache[c]=b,a&&a(d.cache[c])},function(a){})},render:function(a){var b=this,c=a.data.model.result.itemList,d=lib.env.taobaoApp?"newSpuId":"spuid",e=a.data.model.result.scm||"";if(c&&c.length){c.forEach(function(a,c){a.spuPic=b.imgLib.getNewUrl(a.spuPic),a.spuKeyName=d;var e=a[window.d11Info.extKey],f="";if(e&&b.isDouble11){var g=e.split(" ")[0];g&&window.d11Info.extValues[g]&&(f=window.d11Info.extValues[g])}a.extendHtml=f});var f=tmpl("rank_tmpl",{list:c,scm:"scm="+e});$(".con-wrap").html(f)}},requestAndRender:function(){var a=this;a.requestByActiveTag(function(b){a.render(b),a.pageScroller.scrollTo(0,!1),setTimeout(function(){a.pageScroller.refresh(),a.imgLib.fireLazyload()},0)})}},window.addEventListener("DOMContentLoaded",function(){window.spuKeyName="newSpuId",lib.env&&!lib.env.taobaoApp&&(window.spuKeyName="spuid"),new a},!1)}();